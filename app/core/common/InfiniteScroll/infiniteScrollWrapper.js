app.directive("infiniteScrollWrapper",["InstanceManager","$templateCache","$timeout","$http","$q","$rootScope","angularGridInstance",function(t,e,n,i,o,c,r){return{restrict:"E",scope:{config:"="},templateUrl:"/core/common/InfiniteScroll/infiniteScrollWrapper.html",link:function(c,f,g){var a=t.getInstance(c.config.type);c.configAg={gridWidth:c.config.gridWidth||250,gutterSize:c.config.gutterSize||5,refreshOnImgLoad:c.config.refreshOnImgLoad||!0},c.prepare=function(){var t=o.defer();return i.get(c.config.templateUrl,{cache:!0}).then(function(n){e.put(c.config.templateUrl,n.data),c.setModuleConfig(),t.resolve(!0)}).catch(function(e){t.reject(e)}),t.promise},c.prepare().then(function(){a.initialize({firstLotSize:c.config.firstLotSize,nextLotSize:c.config.nextLotSize,ref:c.config.ref,objectBuilder:c.config.objectBuilder}).then(function(){c.config.grid&&n(function(){r.infiniteScrollGrid.refresh()},1500)}).catch(function(t){console.log(t)})}),c.nextLot=function(){a.loadNextLot().then(function(){}).catch(function(t){console.log(t)})},c.setModuleConfig=function(){c.config={distance:c.config.distance||2,parentContainer:c.config.parentContainer||".views-container",firstLotSize:c.config.firstLotSize||14,nextLotSize:c.config.nextLotSize||16,template:e.get(c.config.templateUrl)||null,ref:c.config.ref||null,objectBuilder:c.config.objectBuilder||null,grid:c.config.grid||null,type:c.config.type}},c.$watch("getItems()",function(t,e){c.items=t},!0),c.getItems=function(){return a.getItems()},c.fetching=function(){return a.isFetching()},c.firstLotLoaded=function(){return a.isFirstLotLoaded()},c.itemsRemaining=function(){return a.itemsRemaining()},c.getDisplayedTotal=function(){return a.getDisplayedTotal()}}}}]);