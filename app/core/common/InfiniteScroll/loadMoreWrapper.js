app.directive("loadMoreWrapper",["InstanceManager","$templateCache","$timeout","$http","$q","$rootScope","angularGridInstance",function(t,e,n,i,o,r,c){return{restrict:"E",scope:{config:"="},templateUrl:"/core/common/InfiniteScroll/loadMoreWrapper.html",link:function(r,f,g){var a=t.getInstance(r.config.type);r.configAg={gridWidth:r.config.gridWidth||250,gutterSize:r.config.gutterSize||5,refreshOnImgLoad:r.config.refreshOnImgLoad||!0},r.prepare=function(){var t=o.defer();return i.get(r.config.templateUrl,{cache:!0}).then(function(n){e.put(r.config.templateUrl,n.data),r.setModuleConfig(),t.resolve(!0)}).catch(function(e){t.reject(e)}),t.promise},r.prepare().then(function(){a.initialize({firstLotSize:r.config.firstLotSize,nextLotSize:r.config.nextLotSize,ref:r.config.ref,objectBuilder:r.config.objectBuilder,stateChangeStartListener:r.config.stateChangeStartListener}).then(function(){r.config.grid&&n(function(){c.infiniteScrollGrid.refresh()},1500)}).catch(function(t){console.log(t)})}),r.nextLot=function(){a.loadNextLot().then(function(){}).catch(function(t){console.log(t)})},r.setModuleConfig=function(){r.config={firstLotSize:r.config.firstLotSize||14,nextLotSize:r.config.nextLotSize||16,template:e.get(r.config.templateUrl)||null,ref:r.config.ref||null,objectBuilder:r.config.objectBuilder||null,grid:r.config.grid||!1,type:r.config.type}},r.$watch("getItems()",function(t,e){r.items=t},!0),r.getItems=function(){return a.getItems()},r.fetching=function(){return a.isFetching()},r.firstLotLoaded=function(){return a.isFirstLotLoaded()},r.itemsRemaining=function(){return a.itemsRemaining()},r.getDisplayedTotal=function(){return a.getDisplayedTotal()}}}}]);