app.factory("OrionArticleBuilder",["$q","$rootScope","OrionOpenGraphExtractor","OrionArticleUrlExtractor","OrionDataPurifier",function(r,e,t,i,n){var o,c,a,u=["primary","secondary","terciary","quaternary"];return{build:function(e){var n=this,u=r.defer();return a=e,t.get(a.url).then(function(r){i.extractArticleUrl(a).then(function(e){o=r,c=e,u.resolve(n.buildArticle())}).catch(function(r){u.reject(r)})}).catch(function(r){u.reject()}),u.promise},buildArticle:function(){var r=this,e={url:a.url,title:r.processTitle(),description:r.processDescription(),image:r.processImage(),content:r.processContent()};return!(!e.title||!e.content)&&e},processTitle:function(){for(var r=0,e="",t=!1;r<u.length&&!t;){var i=a.source.extraction.openGraph.title[u[r]];if(void 0!=o[i]&&void 0!=o[i].title){var c=n.purify(o[i].title);e=c,t=!0}else e=!1;++r}return e},processDescription:function(){for(var r=0,e="",t=!1;r<u.length&&!t;){var i=a.source.extraction.openGraph.description[u[r]];if(void 0!=o[i]&&void 0!=o[i].description){var c=n.purify(o[i].description);e=c,t=!0}else e=!1;++r}return e},processImage:function(){for(var r=0,e="",t=!1;r<u.length&&!t;){var i=a.source.extraction.openGraph.image[u[r]];void 0!=o[i]&&void 0!=o[i].image?(e=o[i].image,t=!0):e=!1,++r}return e},processContent:function(){return n.purify(c)}}}]);