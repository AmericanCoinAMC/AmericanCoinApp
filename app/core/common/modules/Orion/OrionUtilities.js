app.factory("OrionUtilities",["$q","$rootScope",function(e,t){return{buildExtractionObject:function(){var t=e.defer(),c=new Source,o=new Category,n={},r={},i=c.db.ref.root.child("categories");return i.once("value").then(function(e){e.forEach(function(e){n[e.key]=o.db.schema.build(e,"snapshot")});var i=c.db.ref.root.child("sources/information").orderByChild("status/active").equalTo(!0);i.once("value").then(function(e){e.forEach(function(e){var o=c.db.ref.root.child("sources/extraction/"+e.key);o.once("value").then(function(o){var n=c.db.ref.root.child("sources/assignments/"+e.key);n.once("value").then(function(n){var i=c.db.ref.root.child("sources/categories/"+e.key);i.once("value").then(function(t){var i=c.db.schema.build(e,"snapshot");r[i.$key]={},r[i.$key].information=i,o.exists()?r[i.$key].extraction=o.val():r[i.$key].extraction=!1,n.exists()?r[i.$key].assignments=n.val():r[i.$key].assignments=!1,t.exists()?r[i.$key].categories=t.val():r[i.$key].categories=!1}).catch(function(e){t.reject(e)})}).catch(function(e){t.reject(e)})}).catch(function(e){t.reject(e)})}),t.resolve({sources:r,categories:n})}).catch(function(e){t.reject(e)})}).catch(function(e){t.reject(e)}),t.promise}}}]);