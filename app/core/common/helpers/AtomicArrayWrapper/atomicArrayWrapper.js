app.directive("atomicArrayWrapper",["$timeout","$http","$q","$rootScope","angularGridInstance",function(i,t,e,r,o){return{restrict:"E",scope:{config:"="},template:'<div ng-include="getWrapperUrl()"></div>',link:function(t,n,a){void 0!=t.config?(t.atomicArray=t.config.atomicArray,t.parentScope=t.config.parentScope||null,t.contentLoaded=!1,t.deactivators=t.config.deactivators||["$stateChangeSuccess"],t.initialize=function(){var r=e.defer();return t.initView(),t.initAgConfig(),t.initDeactivators(),t.atomicArray.$on({ref:t.config.arrayRef,initialLotSize:t.config.firstLotSize||14,nextLotSize:t.config.nextLotSize||16}).then(function(){document.addEventListener(t.atomicArray.id+"_apply_filters",function(){t.applyFilters()},!1),t.viewObject.delayedStart?i(function(){t.config.grid?i(function(){void 0!=o.infiniteScrollGrid&&o.infiniteScrollGrid.refresh(),t.contentLoaded=!0,r.resolve(!0)},1500):(t.contentLoaded=!0,r.resolve(!0))},500):t.config.grid?i(function(){void 0!=o.infiniteScrollGrid&&o.infiniteScrollGrid.refresh(),t.contentLoaded=!0,r.resolve(!0)},1500):i(function(){t.contentLoaded=!0,r.resolve(!0)})}).catch(function(i){console.log(i)}),r.promise},t.initView=function(){t.viewObject={parentContainer:t.config.parentContainer||".views-container",distance:t.config.distance||2,templateUrl:t.config.templateUrl,delayedStart:t.config.delayedStart||!1,animation:t.config.animation||""}},t.initAgConfig=function(){t.agConfig={gridWidth:t.config.gridWidth||300,gutterSize:t.config.gutterSize||20,refreshOnImgLoad:t.config.refreshOnImgLoad||!0}},t.getWrapperUrl=function(){var i="";return"infiniteScroll"==t.config.wrapper?i="/core/common/helpers/AtomicArrayWrapper/infiniteScrollWrapper.html":"loadMore"==t.config.wrapper&&(i="/core/common/helpers/AtomicArrayWrapper/loadMoreWrapper.html"),i},t.initDeactivators=function(){if("string"==typeof t.deactivators)r.$on(t.deactivators,function(){t.atomicArray.$off(),document.removeEventListener(t.atomicArray.id+"_apply_filters",function(){})});else if("object"==typeof t.deactivators)for(var i=0;i<t.deactivators.length;i++)r.$on(t.deactivators[i],function(){t.atomicArray.$off(),document.removeEventListener(t.atomicArray.id+"_apply_filters",function(){})})},t.$watch("atomicArray.items",function(i,e){void 0!=i&&(t.atomicArray.items=i,t.applyFilters())},!0),t.applyFilters=function(){t.atomicArray.filters&&i(function(){for(var i=0;i<t.atomicArray.filters.length;i++)t.atomicArray.items=t.atomicArray.items.filter(t.atomicArray.filters[t.atomicArray.filters[i]])})},t.initialize()):console.log("No config Provided")}}}]);