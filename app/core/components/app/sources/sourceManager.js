app.component("sourceManager",{templateUrl:"/core/components/app/sources/sourceManager.html",controller:["$rootScope","$scope","$timeout","Dialog","$window",function(e,t,o,n,c){var i=new Source;t.config={atomicArray:i.db.atomicArray,parentScope:t,initialLotSize:1e3,nextLotSize:1e3,templateUrl:"/core/components/app/sources/sourceManager.tpl.html",wrapper:"infiniteScroll",animation:{type:"entrance",in:"zoomIn",out:"zoomOut"}},t.itemSelected=!1,t.selectedItem={},t.updateFile=!1,t.submitting=!1,t.save=function(){t.itemSelected?t.update():t.create()},t.create=function(){t.submitting=!0,void 0==t.files[0]?t.selectedItem.file=!1:t.selectedItem.file=t.files[0].lfFile,t.selectedItem.file?i.create(t.selectedItem).then(function(e){t.cancel()}).catch(function(e){console.log(e),Message.toast({text:"Hubo un error.",theme:"toast-red"}),t.cancel()}):(t.submitting=!1,Message.toast({text:"Debes subir una imagen.",theme:"toast-warning"}))},t.update=function(){t.submitting=!0,t.selectedItem.updateFile=t.updateFile,void 0==t.files[0]?t.selectedItem.file=!1:t.selectedItem.file=t.files[0].lfFile;var e=!1;e=!!(t.updateFile&&t.selectedItem.file||!t.updateFile&&!t.selectedItem.file),e?i.alter(t.selectedItem).then(function(){t.cancel()}).catch(function(e){console.log(e),Message.toast({text:"Hubo un error.",theme:"toast-red"}),t.cancel()}):(t.submitting=!1,Message.toast({text:"Debes subir una imagen o cancelar el cambio de imagen.",theme:"toast-warning"}))},t.remove=function(o){e.submitting=!0,i.remove(o).then(function(){t.cancel()}).catch(function(e){console.log(e),Message.toast({text:"Hubo un error.",theme:"toast-red"}),t.cancel()})},t.selectItem=function(e,o){t.itemSelected=!0,t.selectedItem=o,t.showForm(e)},t.showForm=function(e){void 0==t.itemSelected.autoSave&&(t.itemSelected.autoSave=!1);var o={templateUrl:"/core/components/app/sources/sourceForm.html"};n.show(e,t,o)},t.moveToFirst=function(n){e.preloader=!0,i.moveToFirst(n).then(function(){o(function(){t.cancel()})}).catch(function(e){console.log(e),Message.toast({text:"Hubo un error.",theme:"toast-red"}),t.cancel()})},t.moveBefore=function(n,c){e.preloader=!0,i.moveBefore(n,c).then(function(){o(function(){t.cancel()})}).catch(function(e){console.log(e),Message.toast({text:"Hubo un error.",theme:"toast-red"}),t.cancel()})},t.moveNext=function(n,c){e.preloader=!0,i.moveNext(n,c).then(function(){o(function(){t.cancel()})}).catch(function(e){console.log(e),Message.toast({text:"Hubo un error.",theme:"toast-red"}),t.cancel()})},t.moveToLast=function(n){e.preloader=!0,i.moveToLast(n).then(function(){o(function(){t.cancel()})}).catch(function(e){console.log(e),Message.toast({text:"Hubo un error.",theme:"toast-red"}),t.cancel()})},t.changeFile=function(){t.updateFile=!0},t.cancelFileChange=function(){t.updateFile=!1},t.cancel=function(){e.preloader=!1,t.itemSelected=!1,t.selectedItem={},t.submitting=!1,t.updateFile=!1,n.hide()},e.$on("queryUpdate",function(e,o){t.query=o}),t.configuring=!1,t.configSource={},t.configureSource=function(o){t.configuring=!0,t.configSource=o,e.$broadcast("startConfiguringSource",t.configSource)},e.$on("stopConfiguringSource",function(){t.configuring=!1,t.configSource={}}),t.loadUrl=function(e){c.open(e,"_blank")}}]});